---
title: "All Animal Script"
author: "Cole Crossett"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Loading Libraries
```{r}
library(tidyverse)  
library(readxl)     
library(conflicted)  
```

#Clear Environment
```{r}
rm(list = ls())
```

#Load and Prepare Data
```{r}
allanimalcaptures <- read_excel("N:\RStor\CEMML\EdwardsAFB\Mohave_Ground_Squirrel\GIS_and_Monitoring_Data\2024\Field Data\MGS_combined_animaldata_20241205")
head(allanimalcaptures)
```
1. Reads the Excel file containing the survey data.
2. head(allanimalcaptures): Displays the first few rows of the dataset to confirm successful loading.

#Data Preparation
```{r}
all <- allanimalcaptures %>%
  dplyr::select(-species2) %>%  # Drops the column `species2` (secondary species info).
  rename(Species = species1)   # Renames the `species1` column to `Species`.
```
1. Keeps only one species column (species1) for sorting, and renames it for clarity.
2. rm(allanimalcaptures): Removes the original data to free memory since it's no longer needed.

#Create Directories
```{r}
#mainstem <- "N:\\RStor\\CEMML\\GOEA\\Edwards Large Mammal\\Images"
#species <- unique(all$Species)
```
1. mainstem: Specifies the base directory containing the images.
2. unique(all$Species): Retrieves a list of unique species names for folder creation.

#Directories
```{r}
for(i in 1:length(species)){
  to = paste0(mainstem,"\\","QAQC","\\",species[i],"\\")
  if (!dir.exists(to)){
    dir.create(to)
  } else {
    print("dir.exists")
  }
}
```
Iterates over the species list (species):
1. paste0(...): Constructs the directory path for each species.
2. if (!dir.exists(to)): Checks if the folder exists:
3. If it doesnâ€™t, it creates the folder.
4. Otherwise, it prints "dir.exists".

#Copy Images
```{r}
for(i in 1:nrow(all)){
  year = all[i,]$RootFolder
  RelativePath = all[i,]$RelativePath
  picture = all[i,]$File
  iSpecies = all[i,]$Species 
```
Iterates through each row of the dataset.
Extracts relevant metadata for each image:
1. RootFolder: The subdirectory location where the image is stored. 
2. RelativePath: Additional directory structure within the folder.
3. File: The name of the image file.
4. Species: Species associated with the image.

#Construct File Paths
```{r}
from = paste0(mainstem,"\\",year,"\\",RelativePath,"\\",picture)
to = paste0(mainstem,"\\","QAQC","\\",iSpecies,"\\",picture)
```
from: Full path to the source image.
to: Full path where the image should be copied.

#Copy Files:
```{r}
file.copy(from = from,
          to = to,
          overwrite = FALSE)
```
Copies the file from the source location (from) to the species-specific folder (to).
overwrite = FALSE: Prevents overwriting if the file already exists.
